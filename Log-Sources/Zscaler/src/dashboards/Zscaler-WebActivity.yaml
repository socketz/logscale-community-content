name: Zscaler - Web Activity
updateFrequency: never
timeSelector: {}
sharedTimeInterval:
  enabled: true
  isLive: false
  start: 1d
labels:
- Zscaler
- endpoint
widgets:
  6277dbd0-1cf0-43ee-b1bb-e3a85097d3c6:
    x: 8
    height: 4
    queryString: |-
      #Vendor="zscaler" Vendor.product="NSS"
      | user.email=~wildcard(?Username, ignoreCase=true)
      | top(Vendor.protocol)
    end: now
    start: 1d
    width: 4
    y: 13
    interactions:
    - name: Top Protocols
      titleTemplate: 'Protocol: {{ fields.Vendor.protocol }}'
      queryString: Vendor.protocol=?Vendor_protocol
      useWidgetTimeWindow: false
      arguments:
        Vendor_protocol: '["{{fields.Vendor.protocol}}"]'
      openInNewTab: true
      isLive: false
      type: searchlink
    options:
      legendPosition: right
      series: {}
    visualization: pie-chart
    title: Top Protocols
    isLive: false
    type: query
  4fdee0a2-1b02-4fa4-b374-526d601efa3e:
    x: 4
    height: 5
    queryString: |-
      #Vendor="zscaler" Vendor.product="NSS"
      | user.email=~wildcard(?Username, ignoreCase=true)
      | Vendor.action=Blocked
      | timechart(Vendor.urlsupercategory, limit=10)
    end: now
    start: 1d
    width: 4
    y: 21
    interactions:
    - name: Top Blocked Super Categories
      titleTemplate: 'Category: {{ fields.Vendor.urlsupercategory }}'
      queryString: '#Vendor="zscaler" Vendor.product="NSS"|wildcard("*",ignoreCase=true,field=user.email)|Vendor.action=Blocked
        | Vendor.urlsupercategory=?Vendor_urlsupercategory'
      useWidgetTimeWindow: false
      arguments:
        Vendor_urlsupercategory: '["{{fields.Vendor.urlsupercategory}}"]'
      openInNewTab: true
      isLive: false
      type: searchlink
    options:
      connect-points: false
      imputation: none
    visualization: time-chart
    title: Top Blocked Super Categories
    isLive: false
    type: query
  48485316-d46b-47d1-9b41-e7a27a488a9a:
    x: 4
    height: 4
    queryString: |-
      #Vendor="zscaler" Vendor.product="NSS"
      | user.email=~wildcard(?Username, ignoreCase=true)
      | top(Vendor.appname)
    end: now
    start: 1d
    width: 4
    y: 13
    interactions:
    - name: Top Application Names
      titleTemplate: 'Application: {{ fields.Vendor.appname }}'
      queryString: 'Vendor.appname=?Vendor_appname '
      useWidgetTimeWindow: false
      arguments:
        Vendor_appname: '["{{fields.Vendor.appname}}"]'
      openInNewTab: true
      isLive: false
      type: searchlink
    options:
      legendPosition: right
      series: {}
    visualization: pie-chart
    title: Top Application Names
    isLive: false
    type: query
  0d867275-9209-41ed-84e2-304751423faa:
    x: 3
    y: 17
    height: 4
    queryString: |-
      #Vendor="zscaler" Vendor.product="NSS"
      | user.email=~wildcard(?Username, ignoreCase=true)
      | count(user.email, distinct=true)
    end: now
    start: 1d
    width: 3
    options:
      default: {}
    visualization: single-value
    title: Total Distinct Users
    isLive: false
    type: query
  7b45ef95-cf3a-453e-a42a-ad5c43097392:
    x: 0
    height: 5
    queryString: |-
      #Vendor="zscaler" Vendor.product="NSS"
      | user.email=~wildcard(?Username, ignoreCase=true)
      | Vendor.action=Blocked
      | top([Vendor.urlcategory, url.domain])
      | sankey(source="Vendor.urlcategory", target="url.domain")
    visualization: sankey
    end: now
    start: 1d
    width: 6
    y: 4
    interactions:
    - name: Top Blocked Category to Hostname
      titleTemplate: 'Category: {{ fields.source }}, Hostname: {{ fields.target }}'
      queryString: 'Vendor.action=Blocked | Vendor.urlcategory=?Vendor_urlcategory
        | url.domain=?url_domain '
      useWidgetTimeWindow: false
      arguments:
        url_domain: '["{{ fields.target }}"]'
        Vendor_urlcategory: '["{{ fields.source }}"]'
      openInNewTab: true
      isLive: false
      type: searchlink
    title: Top Blocked Categories to Domains
    isLive: false
    type: query
  93b5bd6f-cbf3-4032-afd7-444d392d8319:
    x: 0
    height: 4
    queryString: |-
      #Vendor="zscaler" Vendor.product="NSS"
      | user.email=~wildcard(?Username, ignoreCase=true)
      | top(Vendor.appclass)
    end: now
    start: 1d
    width: 4
    y: 13
    interactions:
    - name: Top Application Classes
      titleTemplate: 'Application: {{ fields.appclass }}'
      queryString: Vendor.appclass=?Vendor_appclass
      useWidgetTimeWindow: false
      arguments:
        Vendor_appclass: '["{{fields.Vendor.appclass}}"]'
      openInNewTab: true
      isLive: false
      type: searchlink
    options:
      legend: true
      legendPosition: right
      series: {}
    visualization: pie-chart
    title: Top Application Classes
    isLive: false
    type: query
  514f5dc2-6d5b-43ef-83d2-21c38fc4e2a7:
    x: 8
    y: 21
    height: 5
    queryString: |-
      #Vendor="zscaler" Vendor.product="NSS"
      | user.email=~wildcard(?Username, ignoreCase=true)
      | Vendor.action=Allowed
      | top(Vendor.useragent, limit=100)
    end: now
    start: 1d
    width: 4
    options:
      cell-overflow: wrap-text
      configured-columns: {}
      row-numbers-enabled: false
    visualization: table-view
    title: Top User Agents
    isLive: false
    type: query
  bdb89fde-8af7-412d-8f3b-cfebc66d8e52:
    x: 6
    height: 4
    queryString: |-
      #Vendor="zscaler" Vendor.product="NSS"
      | user.email=~wildcard(?Username, ignoreCase=true)
      | timechart(http.request.method)
    end: now
    start: 1d
    width: 6
    y: 17
    interactions:
    - name: Request Methods
      titleTemplate: 'Method: {{ fields.http.request.method }}'
      queryString: http.request.method=?http_request_method
      useWidgetTimeWindow: false
      arguments:
        http_request_method: '["{{fields.http.request.method}}"]'
      openInNewTab: true
      isLive: false
      type: searchlink
    options:
      connect-points: false
      imputation: none
    visualization: time-chart
    title: Request Methods
    isLive: false
    type: query
  d2752bdb-a3b8-42a5-a3f2-6dd4ebd44538:
    x: 6
    height: 4
    queryString: |-
      #Vendor="zscaler" Vendor.product="NSS"
      | user.email=~wildcard(?Username, ignoreCase=true)
      | Vendor.requestsize!=0
      | timechart(Vendor.action, function=sum(Vendor.requestsize))
    end: now
    start: 1d
    width: 6
    y: 0
    interactions:
    - name: Actions Over Time by Volume
      titleTemplate: 'Action: {{ fields.Vendor.action }}'
      queryString: '#Vendor="zscaler" Vendor.product="NSS"|Vendor.requestsize!=0 | Vendor.action=?Vendor_action'
      useWidgetTimeWindow: false
      arguments:
        Vendor_action: '["{{fields.Vendor.action}}"]'
      openInNewTab: true
      isLive: false
      type: searchlink
    options:
      connect-points: false
      imputation: none
    visualization: time-chart
    title: Actions Over Time by Volume
    isLive: false
    type: query
  74ec105d-1a29-46dc-81fe-d5a2959631a5:
    x: 6
    height: 5
    queryString: |-
      #Vendor="zscaler" Vendor.product="NSS"
      | user.email=~wildcard(?Username, ignoreCase=true)
      | Vendor.action=Allowed
      | top([Vendor.urlcategory, url.domain], limit=20)
      | sankey(source="Vendor.urlcategory", target="url.domain")
    visualization: sankey
    end: now
    start: 1d
    width: 6
    y: 4
    interactions:
    - name: Top Allowed Categories to Domains
      titleTemplate: 'Category: {{ fields.source }}, Hostname: {{ fields.target }}'
      queryString: '#Vendor="zscaler" Vendor.product="NSS"|Vendor.action=Allowed |
        Vendor.urlcategory=?Vendor_urlcategory | url.domain=?url_domain '
      useWidgetTimeWindow: false
      arguments:
        url_domain: '["{{ fields.target }}"]'
        Vendor_urlcategory: '["{{ fields.source }}"]'
      openInNewTab: true
      isLive: false
      type: searchlink
    title: Top Allowed Categories to Domains
    isLive: false
    type: query
  a2e5c116-a7f0-4d83-9200-e784da7b2600:
    x: 0
    y: 9
    height: 4
    queryString: |-
      #Vendor="zscaler" Vendor.product="NSS"
      | user.email=~wildcard(?Username, ignoreCase=true)
      | Vendor.action=Blocked
      | top(Vendor.urlcategory)
    end: now
    start: 1d
    width: 3
    options:
      cell-overflow: wrap-text
      configured-columns: {}
      row-numbers-enabled: false
    visualization: table-view
    title: Top Blocked Categories
    isLive: false
    type: query
  04a61b55-cb3c-4981-9972-dfdad527e55a:
    x: 0
    height: 4
    queryString: |-
      #Vendor="zscaler" Vendor.product="NSS"
      | user.email=~wildcard(?Username, ignoreCase=true)
      | timechart(user.email, function=sum(Vendor.requestsize), limit=10)
    end: now
    start: 1d
    width: 6
    y: 0
    interactions:
    - name: Top Users by Volume
      titleTemplate: 'User: {{ fields.user.email }}'
      queryString: '#Vendor="zscaler" Vendor.product="NSS" | user.email=?user_email'
      useWidgetTimeWindow: false
      arguments:
        user_email: '["{{fields.user.email}}"]'
      openInNewTab: true
      isLive: false
      type: searchlink
    options:
      connect-points: false
      imputation: none
    visualization: time-chart
    title: Top Users by Volume
    isLive: false
    type: query
  feee03ca-6149-452c-b049-319b5c4d6779:
    x: 0
    y: 17
    height: 4
    queryString: |-
      #Vendor="zscaler" Vendor.product="NSS"
      | user.email=~wildcard(?Username, ignoreCase=true)
      | count("Vendor.location", distinct=true)
    end: now
    start: 1d
    width: 3
    options:
      default: {}
    visualization: single-value
    title: Total Distinct Locations
    isLive: false
    type: query
  15132888-94a5-49af-af03-2f912d35e669:
    x: 9
    y: 9
    height: 4
    queryString: |-
      #Vendor="zscaler" Vendor.product="NSS"
      | user.email=~wildcard(?Username, ignoreCase=true)
      | Vendor.action=Allowed
      | top([url.domain])
    end: now
    start: 1d
    width: 3
    options:
      cell-overflow: wrap-text
      configured-columns: {}
      row-numbers-enabled: false
    visualization: table-view
    title: Top Allowed Domains
    isLive: false
    type: query
  1bda239e-4364-4834-89a6-f99cc39e37e7:
    x: 0
    height: 5
    queryString: |-
      #Vendor="zscaler" Vendor.product="NSS"
      | user.email=~wildcard(?Username, ignoreCase=true)
      | Vendor.action=Allowed
      | timechart(Vendor.urlsupercategory, limit=10)
    end: now
    start: 1d
    width: 4
    y: 21
    interactions:
    - name: Top Allowed Super Categories
      titleTemplate: 'Category: {{ fields.Vendor.urlsupercategory }}'
      queryString: '#Vendor="zscaler" Vendor.product="NSS"|wildcard("*",ignoreCase=true,field=user.email)|Vendor.action=Allowed
        | Vendor.urlsupercategory=?Vendor_urlsupercategory'
      useWidgetTimeWindow: false
      arguments:
        Vendor_urlsupercategory: '["{{fields.Vendor.urlsupercategory}}"]'
      openInNewTab: true
      isLive: false
      type: searchlink
    options:
      connect-points: false
      imputation: none
    visualization: time-chart
    title: Top Allowed Super Categories
    isLive: false
    type: query
  243637b7-fa6f-4566-aced-4d1382eaa60d:
    x: 3
    y: 9
    height: 4
    queryString: |-
      #Vendor="zscaler" Vendor.product="NSS"
      | user.email=~wildcard(?Username, ignoreCase=true)
      | Vendor.action=Blocked
      | top([url.domain])
    end: now
    start: 1d
    width: 3
    options:
      cell-overflow: wrap-text
      configured-columns: {}
      row-numbers-enabled: false
    visualization: table-view
    title: Top Blocked Domains
    isLive: false
    type: query
  75db1df3-4ee7-45c7-8584-aee828cb4930:
    x: 6
    y: 9
    height: 4
    queryString: |-
      #Vendor="zscaler" Vendor.product="NSS"
      | user.email=~wildcard(?Username, ignoreCase=true)
      | Vendor.action=Allowed
      | top(Vendor.urlcategory)
    end: now
    start: 1d
    width: 3
    options:
      cell-overflow: wrap-text
      configured-columns: {}
      row-numbers-enabled: false
    visualization: table-view
    title: Top Allowed Categories
    isLive: false
    type: query
$schema: https://schemas.humio.com/dashboard/v0.20.0
parameters:
  Username:
    label: Username
    order: 50
    type: text
    defaultValue: '*'
    width: 1
